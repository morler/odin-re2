# Security Policy

## 安全承诺

Odin RE2 项目致力于维护安全可靠的正则表达式引擎。我们认真对待所有安全报告，并会及时响应和修复安全问题。

## 支持的版本

| 版本 | 支持状态 |
|------|----------|
| 0.3.x | ✅ 支持 |
| 0.2.x | ⚠️ 仅安全修复 |
| 0.1.x | ❌ 不再支持 |

## 报告安全漏洞

如果您发现安全漏洞，请**不要**在公开的 Issue 中报告。请通过以下方式私下报告：

### 首选方式
- **Email**: security@odin-re2.org
- **PGP Key**: [链接到 PGP 公钥]

### 备用方式
- **GitHub Security Advisory**: 使用 GitHub 的私有安全报告功能
- **Twitter DM**: @odin_re2 (仅用于安全报告)

### 报告内容

请包含以下信息：
- 漏洞的详细描述
- 复现步骤
- 潜在影响
- 受影响的版本
- 如果可能，提供概念验证代码

## 响应时间

我们承诺在以下时间内响应：

| 严重程度 | 响应时间 | 修复时间 |
|----------|----------|----------|
| 严重 | 24 小时 | 7 天 |
| 高危 | 48 小时 | 14 天 |
| 中危 | 72 小时 | 30 天 |
| 低危 | 1 周 | 90 天 |

## 安全最佳实践

### 作为用户

1. **保持更新**: 使用最新版本的 Odin RE2
2. **输入验证**: 验证用户提供的正则表达式
3. **资源限制**: 设置合理的匹配超时时间
4. **沙箱执行**: 在受限环境中执行不可信的模式

### 作为开发者

1. **内存安全**: 使用内存池避免缓冲区溢出
2. **输入验证**: 验证所有外部输入
3. **错误处理**: 正确处理所有错误情况
4. **测试覆盖**: 包含安全相关的测试用例

## 已知安全考虑

### 正则表达式拒绝服务 (ReDoS)

Odin RE2 通过以下方式缓解 ReDoS 攻击：

- **线性时间保证**: 所有模式匹配保证 O(n) 时间复杂度
- **无回溯**: 不支持可能导致指数时间复杂度的特性
- **资源限制**: 内置的资源使用限制

### 内存安全

- **内存池**: 使用内存池防止内存碎片和泄漏
- **边界检查**: 所有数组访问都进行边界检查
- **类型安全**: 利用 Odin 的类型系统防止类型错误

### 输入验证

- **语法检查**: 严格的正则表达式语法验证
- **UTF-8 验证**: 输入文本的 UTF-8 编码验证
- **长度限制**: 模式和输入文本的合理长度限制

## 安全更新

### 更新流程

1. **漏洞评估**: 评估漏洞的严重程度和影响范围
2. **修复开发**: 在私有分支中开发修复
3. **测试验证**: 全面测试修复的有效性
4. **协调发布**: 与相关方协调发布时间
5. **公开披露**: 发布安全更新和公告

### 更新通知

安全更新将通过以下渠道通知：

- GitHub Security Advisories
- 项目邮件列表
- 官方网站公告
- 社交媒体通知

## 安全功能

### 内置保护

```odin
// 示例：安全的模式编译
compile_safe :: proc(pattern: string, arena: ^Arena) -> (^Program, ErrorCode) {
    // 长度检查
    if len(pattern) > MAX_PATTERN_LENGTH {
        return nil, .PatternTooLong
    }
    
    // 复杂度检查
    if is_too_complex(pattern) {
        return nil, .PatternTooComplex
    }
    
    // 标准编译流程
    return compile_nfa(pattern, arena)
}
```

### 资源限制

```odin
// 示例：资源限制配置
Limits :: struct {
    max_pattern_length: int,
    max_input_length:   int,
    max_match_time:     Duration,
    max_memory_usage:   int,
}

DEFAULT_LIMITS :: Limits{
    max_pattern_length = 10000,
    max_input_length   = 1000000,
    max_match_time     = 5 * Second,
    max_memory_usage   = 100 * Megabyte,
}
```

## 威胁模型

### 考虑的威胁

1. **恶意输入**: 恶意构造的正则表达式或输入文本
2. **资源耗尽**: 通过复杂模式耗尽 CPU 或内存
3. **信息泄露**: 通过时间攻击等手段泄露信息
4. **代码注入**: 通过正则表达式注入恶意代码

### 缓解措施

1. **输入验证**: 严格的输入验证和清理
2. **资源限制**: 强制的资源使用限制
3. **时间保证**: 算法时间复杂度保证
4. **内存安全**: 内存池和边界检查

## 安全审计

### 定期审计

- **代码审计**: 每季度进行代码安全审计
- **依赖审计**: 检查第三方依赖的安全性
- **渗透测试**: 定期进行安全渗透测试
- **自动化扫描**: 使用自动化安全扫描工具

### 审计结果

审计结果将在以下情况下公开：
- 修复所有高危漏洞后
- 定期安全报告
- 用户请求（在适当范围内）

## 负责任的披露

### 披露政策

我们遵循负责任的披露原则：

1. **私下报告**: 通过私有渠道报告漏洞
2. **合理时间**: 给予合理时间修复漏洞
3. **协调披露**: 与报告者协调披露时间
4. **公开致谢**: 感谢负责任的漏洞报告者

### 致谢计划

我们感谢所有负责任报告安全漏洞的研究者：

- 在安全公告中致谢
- 在项目贡献者列表中列出
- 提供项目纪念品（如适用）

## 联系信息

### 安全团队

- **安全负责人**: security@odin-re2.org
- **PGP 密钥**: [链接到 PGP 公钥]
- **应急联系**: emergency@odin-re2.org

### 其他联系

- **一般问题**: GitHub Issues
- **安全问题**: security@odin-re2.org
- **媒体咨询**: press@odin-re2.org

## 法律声明

本安全政策仅供参考，不构成法律承诺。我们保留根据情况调整政策的权利。

---

感谢您帮助 Odin RE2 保持安全！